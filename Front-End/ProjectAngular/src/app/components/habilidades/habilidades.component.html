<!-- Habilidades -->
<section class="cuerpo mb-5">
    <div class="d-flex justify-content-between mx-5 mt-3">
      <h3 class="mx-5 center fs-5" id="Hab">HABILIDADES:</h3>
      <app-card></app-card>
    </div>
    <div class="ms-5">
    <button
    (click)="onOpenModal(null!, 'nuevo')"
    type="button"
    class="ms-5 btn-primary"
    *ngIf="isLogged"
    title="Nuevo"
    data-bs-toggle="modal"
    data-bs-target="#nuevaHabilidadModal"
  >
    <i class="fa-solid fa-plus"></i>Nueva Habilidad
  </button></div>
    <!-- Skills Linea 1 -->
    <ul class="flex-container mx-5 m-auto">
      <!-- Skill 1 -->
      <li *ngFor="let habilidad of habilidades" class="bordeImg cardSkill puntos">
        <div class="d-flex justify-content-between">
          <img class="tamR" [src]="habilidad.imgHab" alt="HTML" />
          <div role="progressbar" [attr.aria-valuenow]="habilidad.porcentaje" aria-valuemin="0" aria-valuemax="100" style="--value:{{habilidad.porcentaje}}"></div>
        </div>
        <h4 class="fs-5">{{habilidad.titulo}}</h4>
        <p class="anchop fs-6">
          {{habilidad.descripcion}}
        </p>
        <div class="d-flex" id="eliminar-editar-habilidad" *ngIf="isLogged">
          <button
            (click)="onOpenModal(habilidad, 'editar')"
            type="button"
            class="ms-3 btn-primary"
            title="editar"
            data-bs-toggle="modal"
            data-bs-target="#modificarHabilidadModal"
          >
            <i class="fa-solid fa-pen">Editar</i>
          </button>
          <button
            (click)="onOpenModal(habilidad, 'eliminar')"
            type="button"
            class="ms-5 btn-primary"
            title="borrar"
            data-bs-toggle="modal"
            data-bs-target="#eliminarHabilidadModal"
          >
            <i class="fa-solid fa-eraser">Eliminar</i>
          </button>
        </div>
      </li>
    </ul>
    <!-- <a class="linkMedio mb-2 fs-6" href="">Mostrar todas las habilidades...</a> -->

     <!-- Modal Nueva Habilidad -->
  <div
  class="modal fade"
  id="nuevaHabilidadModal"
  role="dialog"
  data-backdrop="static"
  data-keyboard="false"
  tabindex="-1"
  aria-labelledby="nuevaHabilidadModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content fondo">
      <div class="modal-header">
        <h5 class="modal-title" id="nuevaHabilidadModalLabel">
          Agregar Habilidad
        </h5>
        <button
          type="button"
          class="close botonMenu"
          data-bs-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true"><img class="imgX" width="80%" src="../../../assets/X.svg" alt="X"></span>
        </button>
      </div>
      <div class="modal-body">
        <form #addForm="ngForm" [formGroup]="formHab">
            <input
              type="hidden"
              name="id"
              class="form-control"
              id="id"
            />
            <label for="titulo">Título</label>
            <input
              type="text"
              name="titulo"
              class="form-control"
              formControlName="titulo"
                  required
                  [ngClass]="{
                    'is-invalid': tituloF?.errors && tituloF?.touched,
                    'is-valid': !tituloF?.errors && tituloF?.touched
                  }"
                />
                <div>
                  <p
                    class="text-danger"
                    *ngIf="tituloF?.errors && tituloF?.touched"
                  >
                    Este campo debe contener menos de 50 caracteres
                  </p>
                  <p
                    class="text-danger"
                    *ngIf="tituloF?.hasError('required') && tituloF?.touched"
                  >
                    Este campo es requerido
                  </p>
                </div>
            <label for="descripcion"> Descripción </label>
            <textarea
              type="text"
              name="descripcion"
              class="form-control"
              required
              rows="2"
              formControlName="descripcion"
                  [ngClass]="{
                    'is-invalid': descripcionF?.errors && descripcionF?.touched,
                    'is-valid': !descripcionF?.errors && descripcionF?.touched
                  }"
            ></textarea>
            <div>
              <p
                class="text-danger"
                *ngIf="descripcionF?.errors && descripcionF?.touched"
              >
                Este campo debe contener menos de 500 caracteres
              </p>
              <p
                class="text-danger"
                *ngIf="
                  descripcionF?.hasError('required') &&
                  descripcionF?.touched
                "
              >
                Este campo es requerido
              </p>
            </div>
            <label for="imgHab">Logo Habilidad</label>
            <input
              type="text"
              name="imgHab"
              class="form-control"
              formControlName="imgHab"
              [ngClass]="{
                'is-invalid': imgHabF?.errors && imgHabF?.touched,
                'is-valid': !imgHabF?.errors && imgHabF?.touched
              }"
            />
            <div *ngIf="imgHabF?.errors && imgHabF?.touched">
              <p class="text-danger">
                Este campo debe contener menos de 100 caracteres
              </p>
            </div>
            <label for="porcentaje">Porcentaje</label>
            <input
              type="number"
              min="1" max="100"
              name="porcentaje"
              class="form-control"
              required
              formControlName="porcentaje"
              [ngClass]="{
                'is-invalid': porcentajeF?.errors && porcentajeF?.touched,
                'is-valid': !porcentajeF?.errors && porcentajeF?.touched
              }"
            />
            <div *ngIf="porcentajeF?.errors && porcentajeF?.touched">
              <p class="text-danger">
                Este campo debe contener menos de 3 caracteres numéricos entre 1 y 100.
              </p>
            </div>
          <div class="modal-footer">
            <button
              type="button"
              id="nueva-habilidad-modal"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              (click)="nuevaHabilidad(addForm)"
              [disabled]="addForm.invalid"
              type="submit"
              class="btn btn-primary"
              data-bs-dismiss="modal"
            >
              Agregar
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal para Eliminar Habilidad -->
<div
  *ngFor="let habilidad of habilidades"
  class="modal fade"
  id="eliminarHabilidadModal"
  data-backdrop="static"
  data-keyboard="false"
  tabindex="-1"
  aria-labelledby="eliminarHabilidadModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content fondo">
      <div class="modal-header">
        <h5 class="modal-title" id="eliminarHabilidadModalLabel"></h5>
        <button
          type="button"
          class="close botonMenu"
          data-bs-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true"><img class="imgX" width="80%" src="../../../assets/X.svg" alt="X"></span>
        </button>
      </div>
      <div class="modal-body">
        <p class="fs-5">
          Esta acción eliminará la habilidad seleccionada. ¿Desea
          continuar?
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
          No
        </button>
        <button
          (click)="eliminarHabilidad(elimHabilidad.id)"
          type="button"
          class="btn btn-danger"
          data-bs-dismiss="modal"
        >
          Sí
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal para editar Habilidad -->
<div
  class="modal fade"
  id="modificarHabilidadModal"
  data-backdrop="static"
  data-keyboard="false"
  tabindex="-1"
  aria-labelledby="modificarHabilidadModal"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content fondo">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Editar Habilidad</h5>
        <button
          type="button"
          class="close botonMenu"
          data-bs-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true"><img class="imgX" width="80%" src="../../../assets/X.svg" alt="X"></span>
        </button>
      </div>
      <div class="modal-body">
        <form #editForm="ngForm" [formGroup]="formHab">
          <input type="hidden" name="id" />
          <label for="titulo">Título</label>
            <input
              type="text"
              name="titulo"
              class="form-control"
              formControlName="titulo"
                  required
                  [ngClass]="{
                    'is-invalid': tituloF?.errors && tituloF?.touched,
                    'is-valid': !tituloF?.errors && tituloF?.touched
                  }"
                />
                <div>
                  <p
                    class="text-danger"
                    *ngIf="tituloF?.errors && tituloF?.touched"
                  >
                    Este campo debe contener menos de 50 caracteres
                  </p>
                  <p
                    class="text-danger"
                    *ngIf="tituloF?.hasError('required') && tituloF?.touched"
                  >
                    Este campo es requerido
                  </p>
                </div>
            <label for="descripcion"> Descripción </label>
            <textarea
              type="text"
              name="descripcion"
              class="form-control"
              required
              rows="2"
              formControlName="descripcion"
                  [ngClass]="{
                    'is-invalid': descripcionF?.errors && descripcionF?.touched,
                    'is-valid': !descripcionF?.errors && descripcionF?.touched
                  }"
            ></textarea>
            <div>
              <p
                class="text-danger"
                *ngIf="descripcionF?.errors && descripcionF?.touched"
              >
                Este campo debe contener menos de 500 caracteres
              </p>
              <p
                class="text-danger"
                *ngIf="
                  descripcionF?.hasError('required') &&
                  descripcionF?.touched
                "
              >
                Este campo es requerido
              </p>
            </div>
            <label for="imgHab">Logo Habilidad</label>
            <input
              type="text"
              name="imgHab"
              class="form-control"
              formControlName="imgHab"
              [ngClass]="{
                'is-invalid': imgHabF?.errors && imgHabF?.touched,
                'is-valid': !imgHabF?.errors && imgHabF?.touched
              }"
            />
            <div *ngIf="imgHabF?.errors && imgHabF?.touched">
              <p class="text-danger">
                Este campo debe contener menos de 100 caracteres
              </p>
            </div>
            <label for="porcentaje">Porcentaje</label>
            <input
              type="number"
              min="1" max="100"
              name="porcentaje"
              class="form-control"
              required
              formControlName="porcentaje"
              [ngClass]="{
                'is-invalid': porcentajeF?.errors && porcentajeF?.touched,
                'is-valid': !porcentajeF?.errors && porcentajeF?.touched
              }"
            />
            <div *ngIf="porcentajeF?.errors && porcentajeF?.touched">
              <p class="text-danger">
                Este campo debe contener menos de 3 caracteres numéricos entre 1 y 100.
              </p>
            </div>
          <br />
          <div class="modal-footer">
            <button
              id="modificar-habilidad-modal"
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              (click)="modificarHabilidad(editHabilidad.id, editForm.value)"
              type="button"
              class="btn btn-primary"
              data-bs-dismiss="modal"
            >
              Guardar cambios
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
  </section>

  