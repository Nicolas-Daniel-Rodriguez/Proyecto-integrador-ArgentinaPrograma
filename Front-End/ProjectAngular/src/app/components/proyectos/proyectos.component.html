<!-- Proyectos -->
<section class="cuerpo mb-5">
  <div class="d-flex justify-content-between mx-5 mt-3">
    <h3 class="ms-5 center fs-5" id="Proy">PROYECTOS:</h3>
    <app-card></app-card>
  </div>
  <button
    (click)="onOpenModal(null!, 'nuevo')"
    type="button"
    class="ms-5"
    *ngIf="isLogged"
    title="Nuevo"
    data-bs-toggle="modal"
    data-bs-target="#nuevoProyectoModal"
  >
    <i class="fa-solid fa-plus"></i>Nuevo Proyecto
  </button>
  <!-- Proyecto -->
  <ul>
    <li
      *ngFor="let proyecto of proyectos"
      class="puntos bordeImg cardProyect anchoCard mx-5 mb-4"
      [id]="proyecto.id"
    >
      <div class="d-flex justify-content-center">
        <img class="tamR ms-5" [src]="proyecto.logoProy" alt="LogoEmpresa" />
        <h4 class="m-5 fs-4">
          {{ proyecto.titulo }}
        </h4>
      </div>
      <p class="mt-3 mx-5 fs-6">
        {{ proyecto.descripcion }}
      </p>
      <img
        class="d-block m-auto tamImg my-3"
        [src]="proyecto.imgDemo"
        alt="Imagen de Proyecto"
      />
      <button class="button">
        <a class="fs-6" [href]="proyecto.link">Ver Proyecto...</a>
      </button>
      <div id="eliminar-editar-proyecto" *ngIf="isLogged">
        <button
          (click)="onOpenModal(proyecto, 'editar')"
          type="button"
          class="ms-5"
          title="editar"
          data-bs-toggle="modal"
          data-bs-target="#modificarProyectoModal"
        >
          <i class="fa-solid fa-pen">Editar</i>
        </button>
        <button
          (click)="onOpenModal(proyecto, 'eliminar')"
          type="button"
          class="ms-5"
          title="borrar"
          data-bs-toggle="modal"
          data-bs-target="#eliminarProyectoModal"
        >
          <i class="fa-solid fa-eraser">Eliminar</i>
        </button>
      </div>
    </li>
  </ul>

  <!-- Modal Nuevo Proyecto -->
  <div
    class="modal fade"
    id="nuevoProyectoModal"
    role="dialog"
    data-backdrop="static"
    data-keyboard="false"
    tabindex="-1"
    aria-labelledby="nuevoProyectoModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="nuevoProyectoModalLabel">
            Agregar Proyecto
          </h5>
          <button
            type="button"
            class="close"
            data-bs-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form #addForm="ngForm" (ngSubmit)="nuevoProyecto(addForm)">
            <div class="form-group">
              <input
                type="hidden"
                ngModel
                name="id"
                class="form-control"
                id="id"
                placeholder="Id"
              />
              <label for="titulo">Título</label>
              <input
                type="text"
                ngModel
                name="titulo"
                class="form-control"
                required
              />
            </div>
            <div class="form-group">
              <label for="descripcion">Descripcion </label>
              <input
                type="text"
                ngModel
                name="descripcion"
                class="form-control"
                required
              />
            </div>
            <div class="form-group">
              <label for="logoProy">Logo Proyecto</label>
              <input
                type="text"
                ngModel
                name="logoProy"
                class="form-control"
                required
              />
            </div>
            <div class="form-group">
              <label for="link">Link</label>
              <input
                type="text"
                ngModel
                name="link"
                class="form-control"
                required
              />
            </div>
            <div class="form-group">
              <label for="num">Numero</label>
              <input type="hidden" ngModel name="num" class="form-control" />
            </div>
            <div class="form-group">
              <label for="imgDemo">Imagén Ilustrativa del Proyecto</label>
              <input
                type="hidden"
                ngModel
                name="imgDemo"
                class="form-control"
              />
            </div>
            <div class="modal-footer">
              <button
                type="button"
                id="nuevo-proyecto-modal"
                class="btn btn-danger"
                data-bs-dismiss="modal"
              >
                Cancelar
              </button>
              <button
                [disabled]="addForm.invalid"
                type="submit"
                class="btn btn-primary"
                data-bs-dismiss="modal"
              >
                Agregar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para Eliminar Proyecto -->
  <div
    *ngFor="let proyecto of proyectos"
    class="modal fade"
    id="eliminarProyectoModal"
    data-backdrop="static"
    data-keyboard="false"
    tabindex="-1"
    aria-labelledby="eliminarProyectoModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="eliminarProyectoModalLabel"></h5>
          <button
            type="button"
            class="close"
            data-bs-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>
            Esta acción eliminará "{{ proyecto.titulo }}". ¿Desea continuar?
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
            No
          </button>
          <button
            (click)="eliminarProyecto(elimProyecto.id)"
            type="button"
            class="btn btn-danger"
            data-bs-dismiss="modal"
          >
            Sí
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para editar Proyecto -->
  <div
    *ngFor="let proyecto of proyectos"
    class="modal fade"
    id="modificarProyectoModal"
    data-backdrop="static"
    data-keyboard="false"
    tabindex="-1"
    aria-labelledby="modificarProyectoModal"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Editar Proyecto</h5>
          <button
            type="button"
            class="close"
            data-bs-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form #editForm="ngForm">
            <input type="hidden" name="id" ngModel="{{ proyecto.id }} " />
            <label for="titulo">Título</label><br />
            <input
              ngModel="{{ proyecto.titulo }}"
              type="text"
              name="titulo"
              class="form-control"
            />
            <label for="descripcion">Descripcion</label><br />
            <input
              ngModel="{{ proyecto.descripcion }}"
              type="text"
              name="descripcion"
              class="form-control"
            />
            <label for="logoProy">Logo Proyecto</label><br />
            <input
              ngModel="{{ proyecto.logoProy }}"
              type="text"
              name="logoProy"
              class="form-control"
            />
            <label for="link">Link</label><br />
            <input
              ngModel="{{ proyecto.link }}"
              type="text"
              name="link"
              class="form-control"
            />
            <label for="num">Numero</label><br />
            <input
              ngModel="{{ proyecto.num }}"
              type="hidden"
              name="num"
              class="form-control"
            />
            <label for="imgDemo">Imagén Ilustrativa del Proyecto</label><br />
            <input
              ngModel="{{ proyecto.imgDemo }}"
              type="hidden"
              name="imgDemo"
              class="form-control"
            />
            <br />
            <div class="modal-footer">
              <button
                id="modificar-proyecto-modal"
                type="button"
                class="btn btn-danger"
                data-bs-dismiss="modal"
              >
                Cancelar
              </button>
              <button
                (click)="modificarProyecto(editProyecto.id, editForm.value)"
                type="button"
                class="btn btn-primary"
                data-bs-dismiss="modal"
              >
                Guardar cambios
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
